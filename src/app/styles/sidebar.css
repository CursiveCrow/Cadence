.sidebar {
  /* Defaults for wet-ink sheen variables; JS updates these per pointer */
  --sheen-x: 50%;
  --sheen-y: 50%;
  --sheen-alpha-1: 0.028; /* subtle core reflection */
  --sheen-alpha-2: 0.012; /* soft halo dispersion */
  --sheen-rot: 18deg; /* rotation for anisotropic streak */
  --streak-alpha: 0.008; /* visible ink streak */
  --edge-alpha: 0.12; /* rim highlight intensity */
  --sheen-peak: 0.085; /* bright glint peak for wet-ink look */
  --absorb-alpha: 0.045; /* darker absorption ring around glint */
  --ink-dispersion: 0.018; /* ink dispersion around light source */
  --flow-alpha: 0.006; /* subtle flow animation strength */
  --glint-size: 10px; /* dynamic glint size */
  --glint-offset-x: 10px;
  --glint-offset-y: 12px;
  --lobe-w: 60px; /* anisotropic lobe width */
  --lobe-h: 36px; /* anisotropic lobe height */
  --lobe-offset-x: 8px;
  --lobe-offset-y: 4px;
  --depth-size: 600px;
  --depth-alpha: 0.08;
  --lag-x: 50%;
  --lag-y: 30%;
  --lag-alpha: 0.04;
  /* Deep ink pool base with realistic absorption */
  background: linear-gradient(135deg, rgba(8, 12, 18, 0.65) 0%, rgba(12, 18, 28, 0.55) 100%);
  border-right: 0; /* divider is drawn by .vertical-resizer */
  position: relative;
  z-index: 3;
  box-sizing: border-box;
  height: 100vh; /* Ensure full viewport height */
  min-height: 100%;
  /* subtle inner highlights for wet ink meniscus + right side shadow */
  box-shadow: 
    /* Right side drop shadow for depth */ 3px 0 12px rgba(0, 0, 0, 0.15),
    6px 0 24px rgba(0, 0, 0, 0.08),
    /* Inner highlights for ink surface */ inset 0 1px 0 rgba(25, 35, 55, 0.08),
    inset 0 -1px 0 rgba(0, 0, 0, 0.45), inset 1px 0 0 rgba(15, 25, 40, 0.06);
  overflow: hidden; /* Ensure ink effects stay within sidebar bounds */
  -webkit-backdrop-filter: blur(12px) saturate(125%) brightness(0.95);
  backdrop-filter: blur(12px) saturate(125%) brightness(0.95);
  /* Animation is applied at the end of the sidebar selector */
  /* Multi-layered ink absorption patterns with realistic dispersion */
  background-image: 
    /* Primary absorption pool (deepest layer) */ radial-gradient(
      ellipse calc(var(--depth-size) * 1.4) calc(var(--depth-size) * 0.8) at var(--lag-x)
        var(--lag-y),
      rgba(2, 8, 15, 0) 15%,
      rgba(8, 15, 25, var(--lag-alpha)) 85%,
      rgba(15, 25, 40, calc(var(--lag-alpha) * 0.6)) 100%
    ),
    /* Secondary absorption with ink dispersion */
      radial-gradient(
        circle var(--depth-size) at var(--sheen-x) var(--sheen-y),
        rgba(5, 12, 22, 0) 8%,
        rgba(12, 20, 35, calc(var(--depth-alpha) * 1.2)) 65%,
        rgba(20, 30, 45, calc(var(--depth-alpha) * 0.4)) 100%
      ),
    /* Ink dispersion around light source */
      radial-gradient(
        circle 280px at calc(var(--sheen-x) + var(--glint-offset-x) * 0.5)
          calc(var(--sheen-y) + var(--glint-offset-y) * 0.5),
        rgba(15, 25, 45, var(--ink-dispersion)) 0%,
        rgba(8, 18, 35, calc(var(--ink-dispersion) * 1.8)) 25%,
        rgba(0, 0, 0, 0) 75%
      ),
    /* Primary absorption ring */
      radial-gradient(
        circle 200px at calc(var(--sheen-x) + var(--glint-offset-x))
          calc(var(--sheen-y) + var(--glint-offset-y)),
        rgba(0, 0, 0, 0) 0%,
        rgba(5, 10, 20, var(--absorb-alpha)) 35%,
        rgba(12, 18, 30, calc(var(--absorb-alpha) * 0.7)) 60%,
        rgba(0, 0, 0, 0) 85%
      ),
    /* Ink fiber texture (fine grain) */
      radial-gradient(0.6px 0.6px at 28% 32%, rgba(35, 45, 65, 0.025) 0, rgba(35, 45, 65, 0) 100%),
    radial-gradient(0.8px 0.8px at 65% 68%, rgba(25, 35, 55, 0.018) 0, rgba(25, 35, 55, 0) 100%),
    /* Additional micro-texture for realism */
      radial-gradient(1px 1px at 45% 25%, rgba(40, 50, 70, 0.012) 0, rgba(40, 50, 70, 0) 100%);
  background-blend-mode: multiply, multiply, multiply, multiply, screen, screen, screen;
  background-size: 100% 100%, 100% 100%, 100% 100%, 100% 100%, 2px 2px, 2px 2px, 2px 2px;
  background-repeat: no-repeat, no-repeat, no-repeat, no-repeat, repeat, repeat, repeat;
  /* Add subtle background flow animation for liquid movement */
  animation: ink-surface-breathing 16s ease-in-out infinite, ink-pool-flow 20s linear infinite;
}

/* Sidebar header row */
.sidebar-header {
  display: flex;
  align-items: center;
  margin-top: 12px;
  margin-bottom: 8px;
  gap: 6px;
  padding-right: 0;
  justify-content: flex-start;
}

/* Sidebar labels overlay container */
.sidebar-labels-layer {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: 1;
  padding-left: 12px;
  padding-right: 12px;
}

/* Single label row */
.sidebar-label-item {
  position: absolute;
  left: 0;
  right: 0;
  transform: translateY(-50%);
  display: flex;
  align-items: center;
  gap: 8px;
  padding-right: 12px;
  justify-content: flex-end;
}

.sidebar-label-name {
  color: #bcc3d6;
  white-space: nowrap;
  text-align: right;
}

.sidebar-controls {
  margin-left: 8px;
}

.ui-pointer-auto {
  pointer-events: auto;
}

/* Wet-ink sheen overlay that follows the cursor as a light source */
.sidebar::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  height: 100%;
  width: 100%;
  /* Realistic wet-ink speculars with blue-tinted highlights and proper Fresnel reflection */
  background: 
    /* Bright specular glint (primary reflection) */ radial-gradient(
      circle var(--glint-size) at calc(var(--sheen-x) + var(--glint-offset-x))
        calc(var(--sheen-y) + var(--glint-offset-y)),
      rgba(180, 200, 240, var(--sheen-peak)) 0%,
      rgba(140, 170, 220, calc(var(--sheen-peak) * 0.7)) 35%,
      rgba(100, 140, 200, calc(var(--sheen-peak) * 0.3)) 60%,
      rgba(100, 140, 200, 0) 100%
    ),
    /* Sharp concentrated rim light */
      radial-gradient(
        ellipse 2px 60% at calc(100% - 0.5px) var(--sheen-y),
        rgba(200, 220, 255, var(--edge-peak)) 0%,
        rgba(180, 200, 240, var(--edge-peak)) 2%,
        rgba(160, 180, 220, var(--edge-alpha)) 8%,
        rgba(140, 160, 200, calc(var(--edge-alpha) * 0.6)) 20%,
        rgba(120, 140, 180, calc(var(--edge-alpha) * 0.2)) 35%,
        rgba(120, 140, 180, 0) 50%
      ),
    /* Primary anisotropic lobe (meniscus reflection) */
      radial-gradient(
        ellipse var(--lobe-w) var(--lobe-h) at calc(var(--sheen-x) + var(--lobe-offset-x))
          calc(var(--sheen-y) + var(--lobe-offset-y)),
        rgba(130, 150, 190, var(--sheen-alpha-1)) 0%,
        rgba(110, 130, 170, calc(var(--sheen-alpha-1) * 0.8)) 45%,
        rgba(90, 110, 150, calc(var(--sheen-alpha-1) * 0.3)) 75%,
        rgba(90, 110, 150, 0) 100%
      ),
    /* Secondary lobe (ink dispersion pattern) */
      radial-gradient(
        ellipse calc(var(--lobe-w) * 0.8) calc(var(--lobe-h) * 0.6) at
          calc(var(--sheen-x) + var(--lobe-offset-x) + 12px)
          calc(var(--sheen-y) + var(--lobe-offset-y) + 8px),
        rgba(110, 130, 170, calc(var(--sheen-alpha-1) * 0.5)) 0%,
        rgba(90, 110, 150, calc(var(--sheen-alpha-1) * 0.25)) 65%,
        rgba(90, 110, 150, 0) 100%
      ),
    /* Ink surface diffuse reflection */
      radial-gradient(
        circle 650px at calc(var(--sheen-x) + 15px) calc(var(--sheen-y) + 20px),
        rgba(80, 100, 140, calc(var(--sheen-alpha-2) * 1.4)) 0%,
        rgba(70, 90, 130, calc(var(--sheen-alpha-2) * 0.8)) 60%,
        rgba(70, 90, 130, 0) 100%
      ),
    /* Subtle ink flow patterns */
      radial-gradient(
        ellipse 480px 320px at calc(var(--sheen-x) - 20px) calc(var(--sheen-y) + 30px),
        rgba(90, 110, 150, var(--flow-alpha)) 0%,
        rgba(70, 90, 130, calc(var(--flow-alpha) * 0.6)) 70%,
        rgba(70, 90, 130, 0) 100%
      );
  mix-blend-mode: screen; /* behave like light on wet ink surface */
  transition: opacity 180ms ease-out, background 0.12s ease-out;
  opacity: 1; /* always present, intensity controlled by CSS vars */
  /* Add subtle pulsing to simulate liquid surface activity */
  animation: ink-sheen-pulse 18s ease-in-out infinite;
}

/* Anisotropic ink flow streak with realistic viscous behavior */
.sidebar::after {
  content: '';
  position: absolute;
  pointer-events: none;
  /* Smoothly constrain positioning to stay within sidebar bounds */
  left: var(--sheen-x);
  top: var(--sheen-y);
  width: 280px;
  height: 85px;
  transform: translate(-50%, -50%) rotate(var(--sheen-rot));
  border-radius: 85px;
  /* Ensure streak stays within sidebar boundaries */
  clip-path: inset(0);
  /* Multi-layered ink flow streaks simulating viscous surface tension */
  background: 
    /* Primary ink flow (bright center) */ linear-gradient(
      90deg,
      rgba(140, 170, 220, 0) 0%,
      rgba(120, 150, 200, calc(var(--streak-alpha) * 0.8)) 18%,
      rgba(160, 180, 230, calc(var(--streak-alpha) * 2.2)) 45%,
      rgba(140, 170, 210, calc(var(--streak-alpha) * 1.4)) 52%,
      rgba(120, 150, 200, calc(var(--streak-alpha) * 0.8)) 82%,
      rgba(140, 170, 220, 0) 100%
    ),
    /* Secondary flow (subtle shoulders) */
      linear-gradient(
        90deg,
        rgba(100, 130, 180, 0) 0%,
        rgba(90, 120, 170, calc(var(--streak-alpha) * 0.45)) 20%,
        rgba(110, 140, 190, calc(var(--streak-alpha) * 1.1)) 48%,
        rgba(100, 130, 180, calc(var(--streak-alpha) * 0.9)) 53%,
        rgba(90, 120, 170, calc(var(--streak-alpha) * 0.45)) 80%,
        rgba(100, 130, 180, 0) 100%
      ),
    /* Tertiary dispersion (ink spreading) */
      linear-gradient(
        90deg,
        rgba(80, 110, 160, 0) 0%,
        rgba(70, 100, 150, calc(var(--streak-alpha) * 0.25)) 25%,
        rgba(85, 115, 165, calc(var(--streak-alpha) * 0.6)) 50%,
        rgba(70, 100, 150, calc(var(--streak-alpha) * 0.25)) 75%,
        rgba(80, 110, 160, 0) 100%
      );
  background-repeat: no-repeat, no-repeat, no-repeat;
  background-size: 100% 100%, 95% 90%, 110% 120%;
  background-position: 0 0, 8px 6px, -12px -8px;
  filter: blur(16px);
  mix-blend-mode: color-dodge;
  opacity: 1;
  will-change: transform;
  /* No position transitions for instant following; only background/transform for smooth effects */
  transition: transform 0.12s ease-out, background 0.12s ease-out;
  /* Add subtle animation for liquid movement */
  animation: ink-flow 14s ease-in-out infinite;
}

/* Respect reduced motion preferences */
@media (prefers-reduced-motion: reduce) {
  .sidebar {
    animation: none;
  }
  .sidebar::before {
    animation: none;
    transition: none;
  }
  .sidebar::after {
    animation: none;
    transition: none;
  }
}

@keyframes ink-flow {
  0% {
    filter: blur(16px) hue-rotate(0deg) brightness(1) contrast(1);
    opacity: 1;
    transform: translate(-50%, -50%) rotate(var(--sheen-rot)) scale(1);
  }
  25% {
    filter: blur(14px) hue-rotate(5deg) brightness(1.1) contrast(1.05);
    opacity: 0.85;
    transform: translate(-50%, -50%) rotate(calc(var(--sheen-rot) + 2deg)) scale(1.04);
  }
  50% {
    filter: blur(18px) hue-rotate(-3deg) brightness(0.9) contrast(0.95);
    opacity: 1.15;
    transform: translate(-50%, -50%) rotate(calc(var(--sheen-rot) - 1deg)) scale(0.96);
  }
  75% {
    filter: blur(15px) hue-rotate(2deg) brightness(1.05) contrast(1.02);
    opacity: 0.9;
    transform: translate(-50%, -50%) rotate(calc(var(--sheen-rot) + 1deg)) scale(1.02);
  }
  100% {
    filter: blur(16px) hue-rotate(0deg) brightness(1) contrast(1);
    opacity: 1;
    transform: translate(-50%, -50%) rotate(var(--sheen-rot)) scale(1);
  }
}

/* Subtle background flow animation for the main ink pool */
@keyframes ink-pool-flow {
  0% {
    background-position: 0 0, 0 0, 0 0, 0 0, 28% 32%, 65% 68%, 45% 25%;
  }
  25% {
    background-position: -5px 3px, 3px -3px, -3px 5px, 2px -2px, 30% 34%, 67% 66%, 43% 27%;
  }
  50% {
    background-position: 3px -5px, -3px 3px, 5px -3px, -2px 2px, 26% 30%, 63% 70%, 47% 23%;
  }
  75% {
    background-position: -3px 4px, 2px -4px, 4px 3px, 1px -1px, 29% 33%, 66% 67%, 44.5% 26%;
  }
  100% {
    background-position: 0 0, 0 0, 0 0, 0 0, 28% 32%, 65% 68%, 45% 25%;
  }
}

/* Breathing effect for ink surface tension */
@keyframes ink-surface-breathing {
  0% {
    backdrop-filter: blur(12px) saturate(125%) brightness(0.95);
    filter: brightness(1);
  }
  33% {
    backdrop-filter: blur(11px) saturate(130%) brightness(0.98);
    filter: brightness(1.03);
  }
  66% {
    backdrop-filter: blur(13px) saturate(120%) brightness(0.93);
    filter: brightness(0.97);
  }
  100% {
    backdrop-filter: blur(12px) saturate(125%) brightness(0.95);
    filter: brightness(1);
  }
}

/* Subtle pulsing for the main sheen overlay */
@keyframes ink-sheen-pulse {
  0% {
    opacity: 1;
    filter: brightness(1);
  }
  30% {
    opacity: 0.75;
    filter: brightness(0.9);
  }
  60% {
    opacity: 1.2;
    filter: brightness(1.1);
  }
  100% {
    opacity: 1;
    filter: brightness(1);
  }
}

/* Resizer sits on top of the sidebar border without creating a visible gap */
.vertical-resizer {
  position: absolute;
  width: 10px; /* 5px overlaps sidebar, 5px overlaps canvas; center is boundary */
  cursor: col-resize;
  z-index: 5;
  top: 0;
  bottom: 0;
  border-left: 0; /* transparent handle */
  background: transparent;
  outline: none;
  /* no own shadow; shadow is drawn via ::after to the right */
  box-shadow: none;
}
